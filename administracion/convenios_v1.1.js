$(document).ready(function(){muestra_convenios();});function muestra_convenios(){$("#contenedor_error").css("display","none");$("#txtParametro").val("");var _1="opcion=1&parametro=-5";llamarAjax("convenios_ajax.php",_1,"principal_convenios","");};function buscarConvenio(){$("#frmBuscarConvenio").validate({rules:{txtParametro:{required:true,},},submitHandler:function(){var _2=$("#txtParametro").val();var _3="opcion=1&parametro="+_2;llamarAjax("convenios_ajax.php",_3,"principal_convenios","");return false;},});};function formNuevoConvenio(_4){var _5="opcion=2&parametro="+_4;llamarAjax("convenios_ajax.php",_5,"principal_convenios","");};function guardaModificaConvenio(_6){$("#frmNuevoConvenio").validate({rules:{txtNombre:{required:true,},txtCodAdministradora:{maxlength:6,},},submitHandler:function(){var _7=str_encode($("#txtNombre").val());var _8=$("#txtCodAdministradora").val();var _9=$("#cmbTipoDocumento").val();var _a=str_encode($("#txtNumeroDocumento").val());var _b=$("#indActivo").is(":checked")?1:0;var _c=$("#idConvenio").val();var _d=$("#indEco").is(":checked")?1:0;var _e=$("#indNumAut").is(":checked")?1:0;var _f=$("#indNumAutObl").is(":checked")?1:0;var _10=$("#indNumCarnet").is(":checked")?1:0;var _11=$("#indNumCarnetObl").is(":checked")?1:0;var _12=$("#tablaPlanes tr").length;if(_12>="3"){var _13="opcion=3&parametro="+_6+"&nombre="+_7+"&cmbTipoDocumento="+_9+"&txtNumeroDocumento="+_a+"&indActivo="+_b+"&idConvenio="+_c+"&idEco="+_d+"&txtCodAdministradora="+_8+"&indNumAut="+_e+"&indNumAutObl="+_f+"&indNumCarnet="+_10+"&indNumCarnetObl="+_11;if($("#tablaPlanesNull").is(":visible")){llamarAjax("convenios_ajax.php",_13,"hdd_resultado","verificaGuardar();");}else{llamarAjax("convenios_ajax.php",_13,"hdd_resultado","verificaGuardarPlanes();");}}return false;},});};function verificaGuardarPlanes(){var _14=[];var _15=$("#tablaPlanes tr").length;var _16="";var _17="";var _18="";for(i=2;i<=(_15-1);i++){_14[0]=$("#tablaPlanes tr:eq("+i+") td:eq(1)").text();_14[1]=$("#tablaPlanes tr:eq("+i+") td:eq(2)").attr("id");_14[2]=$("#tablaPlanes tr:eq("+i+") td:eq(3)").attr("id");var _19="opcion=5&txtNombrePlan="+_14[0]+"&tipoPago="+_14[1]+"&indActivoPlan="+_14[2]+"&idConvenio=0&tipoAccion=1&idPlan=0";llamarAjax("convenios_ajax.php",_19,"","");}verificaGuardar();};function verificaGuardar(){var _1a=$("#hdd_resultado").text();if(_1a=="1"){$("#contenedor_exito").css("display","block");$("#contenedor_exito").html("El registro ha sido guardado");muestra_convenios();setTimeout(function(){$("#contenedor_exito").css("display","none");},5000);}else{if(_1a=="-1"){$("#contenedor_error").css("display","block");$("#contenedor_error").html("Se ha producido un error. vuelva a intentarlo");}}};function seleccionar_convenio(_1b,_1c){var _1d="opcion=2&parametro="+_1c+"&idConvenio="+_1b;llamarAjax("convenios_ajax.php",_1d,"principal_convenios","");};function agregarConvenio(_1e){$("#frmAgregarPlan").validate({rules:{txtNombrePlan:{required:true,},cmb_tipoPago:{required:true,},cmb_tipo_usuario:{required:true,},},submitHandler:function(){var _1f=$("#idConvenio").val();var _20=$("#txtNombrePlan").val();var _21=$("#cmb_tipoPago").val();var _22=$("#indActivoPlan").is(":checked")?1:0;var _23=0;var _24=$("#cmb_tipo_usuario").val();if(_1f!="0"){if(_1e==0){_23=1;}else{if(_1e!=0){_23=2;}}var _25="opcion=5&idConvenio="+_1f+"&tipoAccion="+_23+"&txtNombrePlan="+_20+"&tipoPago="+_21+"&indActivoPlan="+_22+"&idPlan="+_1e+"&tipoUsuario="+_24;llamarAjax("convenios_ajax.php",_25,"hdd_resultadoPlanes","verificaGuardaPlan();");}else{if(_1f=="0"){var _26="";var _27="";if(_22=="1"){_26="Activo";_27="activo";}else{if(_22=="0"){_26="No Activo";_27="inactivo";}}var _28=0;_28=Math.floor(Math.random()*(75-25+1))+25;$("#tablaPlanesNull").remove();$("#tablaPlanes").append("<tr id=\""+_28+"\" onclick=\"edicionPlan(0);\"><td>No definido</td><td>"+_20+"</td><td id=\""+_21+"\">"+$("#cmb_tipoPago option:selected").text()+"</td><td id=\""+_22+"\"><span class=\""+_27+"\">"+_26+"</span></td><td><img onclick=\"removerPlanTmp("+_28+")\" src=\"../imagenes/Error-icon.png\" /></td></tr>");ventanaAgregarPlan(0,0);}}return false;},});};function verificaGuardaPlan(){var _29=$("#hdd_resultadoPlanes").text();if(_29=="-1"){$("#contenedor_error").css("display","block");$("#contenedor_error").html("Se ha producido un error. vuelva a intentarlo");}else{if(_29!="-1"){var _2a=1;var _2b=$("#idConvenio").val();ventanaAgregarPlan(0,0);seleccionar_convenio(_2b,_2a);}}};function edicionPlan(_2c){if(_2c=="0"){}else{if(_2c!="0"){ventanaAgregarPlan(1,_2c);}}};function ventanaAgregarPlan(_2d,_2e){if(_2d==1){$("#contenedor_error").remove();$("#fondo_negro").css("display","block");$("#d_centro").slideDown(400).css("display","block");$("#a_cierre_panel").remove();$("#d_centro").prepend("<a name=\"a_cierre_panel2\" id=\"a_cierre_panel2\" href=\"#\" onclick=\"ventanaAgregarPlan(0);\"></a>");var _2f=$("#idConvenio").val();var _30="opcion=4&idConvenio="+_2f+"&idPlan="+_2e;llamarAjax("convenios_ajax.php",_30,"d_interno","");posicionarDivFlotante("d_centro");}else{if(_2d==0){$("#a_cierre_panel2").remove();$("#d_centro").css("display","none");$("#fondo_negro").css("display","none");$("#advertenciasg").prepend("<div class=\"contenedor_error\" id=\"contenedor_error\"></div>");}}};function removerPlanTmp(id){var _31=$("#tablaPlanes tr").length;$("#"+id+"").remove();if(_31<=3){$("#tablaPlanes").append("<tr id='tablaPlanesNull'><td colspan=\"5\">No hay resultados</td></tr>");}};